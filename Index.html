<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conway's Game of Life</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: white;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        #container {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        #controls {
            padding: 12px;
            background: #f5f5f5;
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        button {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            background: #2563eb;
            color: white;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: background 0.2s;
        }
        
        button:hover {
            background: #1d4ed8;
        }
        
        button:active {
            transform: scale(0.98);
        }
        
        button.secondary {
            background: #6b7280;
        }
        
        button.secondary:hover {
            background: #4b5563;
        }
        
        #canvas {
            flex: 1;
            display: block;
            cursor: crosshair;
        }
        
        label {
            font-size: 14px;
            color: #374151;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        input[type="range"] {
            width: 100px;
        }
    </style>
</head>
<body>
    <div id="container">
        <div id="controls">
            <button id="playPause">Play</button>
            <button id="step" class="secondary">Step</button>
            <button id="clear" class="secondary">Clear</button>
            <button id="random" class="secondary">Random</button>
            <label>
                Speed:
                <input type="range" id="speed" min="1" max="60" value="10">
                <span id="speedValue">10</span>
            </label>
        </div>
        <canvas id="canvas"></canvas>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const playPauseBtn = document.getElementById('playPause');
        const stepBtn = document.getElementById('step');
        const clearBtn = document.getElementById('clear');
        const randomBtn = document.getElementById('random');
        const speedSlider = document.getElementById('speed');
        const speedValue = document.getElementById('speedValue');
        
        const CELL_SIZE = 10;
        const CELL_RADIUS = 2;
        const ALIVE_COLOR = '#1f2937';
        
        let cols, rows;
        let grid = [];
        let isPlaying = false;
        let speed = 10;
        let lastUpdate = 0;
        
        function resizeCanvas() {
            const controlsHeight = document.getElementById('controls').offsetHeight;
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight - controlsHeight;
            
            cols = Math.floor(canvas.width / CELL_SIZE);
            rows = Math.floor(canvas.height / CELL_SIZE);
            
            const oldGrid = grid;
            grid = createEmptyGrid();
            
            if (oldGrid.length > 0) {
                for (let i = 0; i < Math.min(rows, oldGrid.length); i++) {
                    for (let j = 0; j < Math.min(cols, oldGrid[0].length); j++) {
                        grid[i][j] = oldGrid[i][j];
                    }
                }
            }
            
            draw();
        }
        
        function createEmptyGrid() {
            return Array(rows).fill(null).map(() => Array(cols).fill(false));
        }
        
        function countNeighbors(row, col) {
            let count = 0;
            for (let i = -1; i <= 1; i++) {
                for (let j = -1; j <= 1; j++) {
                    if (i === 0 && j === 0) continue;
                    const newRow = (row + i + rows) % rows;
                    const newCol = (col + j + cols) % cols;
                    if (grid[newRow][newCol]) count++;
                }
            }
            return count;
        }
        
        function nextGeneration() {
            const newGrid = createEmptyGrid();
            
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    const neighbors = countNeighbors(i, j);
                    const cell = grid[i][j];
                    
                    if (cell && (neighbors === 2 || neighbors === 3)) {
                        newGrid[i][j] = true;
                    } else if (!cell && neighbors === 3) {
                        newGrid[i][j] = true;
                    }
                }
            }
            
            grid = newGrid;
        }
        
        function drawRoundedRect(x, y, width, height, radius) {
            ctx.beginPath();
            ctx.moveTo(x + radius, y);
            ctx.lineTo(x + width - radius, y);
            ctx.arcTo(x + width, y, x + width, y + radius, radius);
            ctx.lineTo(x + width, y + height - radius);
            ctx.arcTo(x + width, y + height, x + width - radius, y + height, radius);
            ctx.lineTo(x + radius, y + height);
            ctx.arcTo(x, y + height, x, y + height - radius, radius);
            ctx.lineTo(x, y + radius);
            ctx.arcTo(x, y, x + radius, y, radius);
            ctx.closePath();
            ctx.fill();
        }
        
        function draw() {
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.fillStyle = ALIVE_COLOR;
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    if (grid[i][j]) {
                        drawRoundedRect(
                            j * CELL_SIZE,
                            i * CELL_SIZE,
                            CELL_SIZE,
                            CELL_SIZE,
                            CELL_RADIUS
                        );
                    }
                }
            }
        }
        
        function animate(timestamp) {
            if (isPlaying) {
                const interval = 1000 / speed;
                if (timestamp - lastUpdate >= interval) {
                    nextGeneration();
                    draw();
                    lastUpdate = timestamp;
                }
            }
            requestAnimationFrame(animate);
        }
        
        playPauseBtn.addEventListener('click', () => {
            isPlaying = !isPlaying;
            playPauseBtn.textContent = isPlaying ? 'Pause' : 'Play';
        });
        
        stepBtn.addEventListener('click', () => {
            nextGeneration();
            draw();
        });
        
        clearBtn.addEventListener('click', () => {
            grid = createEmptyGrid();
            draw();
        });
        
        randomBtn.addEventListener('click', () => {
            grid = createEmptyGrid();
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    grid[i][j] = Math.random() > 0.7;
                }
            }
            draw();
        });
        
        speedSlider.addEventListener('input', (e) => {
            speed = parseInt(e.target.value);
            speedValue.textContent = speed;
        });
        
        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            const col = Math.floor(x / CELL_SIZE);
            const row = Math.floor(y / CELL_SIZE);
            
            if (row >= 0 && row < rows && col >= 0 && col < cols) {
                grid[row][col] = !grid[row][col];
                draw();
            }
        });
        
        window.addEventListener('resize', resizeCanvas);
        
        resizeCanvas();
        requestAnimationFrame(animate);
    </script>
</body>
</html>
